{"version":3,"sources":["../../../temp/inline/config/config.ts"],"names":[],"mappings":"AAAA,OAAO,EAAA,UAAE,EAAW,YAAA,EAAc,WAAA,EAAa,MAAA,EAAO,MAAM,eAAA,CAAgB;AAG5E,MAAM,CAAC,IAAM,UAAA,GAAa,IAAI,WAAA,CAAY,YAAC,CAAY,CAAC;AAGxD;IASE,sBAAa,MAA4B;QAA5B,uBAAA,EAAA,aAA4B;QAPzC,aAAQ,GAAG,IAAI,YAAY,EAAE,CAAC;QAEtB,WAAM,GAAkB;YAChC,SAAS,EAAE,CAAC;YACZ,MAAM,EAAE,CAAC;SACR,CAAC;QAGA,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,EAAE,MAAM,IAAI,EAAE,CAAC,CAAC;IAC7D,CAAC;IAED,6BAAM,GAAN,UAAO,MAAqB;QAC1B,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,EAAE,MAAM,IAAI,EAAE,CAAC,CAAC;QAC3D,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;IACvB,CAAC;IAED,0BAAG,GAAH,UAAI,GAAW;QACb,MAAM,CAAO,IAAI,CAAC,MAAO,CAAC,GAAG,CAAC,CAAC;IACjC,CAAC;IAQH,mBAAC;AAAD,CA5BA,AA4BC;;AAPM,uBAAU,GAA0B;IAC3C,EAAE,IAAI,EAAE,UAAU,EAAE;CACnB,CAAC;AACF,kBAAkB;AACX,2BAAc,GAAmE,cAAM,OAAA;IAC9F,EAAC,IAAI,EAAE,SAAS,EAAE,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,UAAU,EAAG,EAAE,EAAG,EAAC;CACxE,EAF6F,CAE7F,CAAC;AAGF,qBAAqB;AACrB,MAAM,6BAP6B,MAAuC;IAAvC,uBAAA,EAAA,WAAS,sBAAE,EAAuB,IAAA,EAAK;IAQxE,MAAM,CAPC,UAAA,WAAuB;QACxB,IAAA,0BAAyC,EAAvC,sBAAA,EAAU,4BAAA,CAAsC;QAStD,WAAW,CAPC,SAAC,CAAS,QAAC,GAAU;YAAA,iBAwBhC;YAhBC,IAPM,iBAAA,GAAoB,IAAA,CAAK,MAAC,CAAM,sBAAC,CAAsB,CAAC;YAS9D,EAAE,CAAC,CAAC,CAPC,iBAAC,IAAoB,CAAA,iBAAE,CAAiB,YAAC,CAAY,CAAC,CAAA;gBAQzD,MAPM,KAAA,CAAM,2DAAC,MAAwD,CAAM,sBAAC,OAAsB,CAAG,CAAC;YAQxG,CAAC;YAED,IAAI,CAPC,qBAAC,GAAuB,IAAA,CAAK,MAAC,CAAM,QAAC,CAAQ,SAAC,CAAS;gBAQ1D,EAAE,CAAC,CAAC,KAPC,CAAI,kBAAC,CAAkB,CAAC,CAAA;oBAQ3B,KAAI,CAPC,kBAAC,EAAkB,CAAE;gBAQ5B,CAAC;gBACD,iBAAiB,CAPC,YAAC,EAAY,CAAE;YAQnC,CAAC,CAPC,CAAC;YASH,EAAE,CAAC,CAAC,QAPC,CAAQ,CAAC,CAAA;gBAQZ,QAAQ,CAPC,IAAC,CAAI,IAAC,CAAI,CAAC;YAQtB,CAAC;QACH,CAAC,CAPC;QASF,WAAW,CAPC,SAAC,CAAS,WAAC,GAAa;YAQlC,EAAE,CAAC,CAAC,IAPC,CAAI,qBAAC,CAAqB,CAAC,CAAA;gBAQ9B,IAAI,CAPC,qBAAC,CAAqB,WAAC,EAAW,CAAE;gBAQzC,IAAI,CAPC,qBAAC,GAAuB,IAAA,CAAK;YAQpC,CAAC;YAED,EAAE,CAAC,CAAC,WAPC,CAAW,CAAC,CAAA;gBAQf,WAAW,CAPC,IAAC,CAAI,IAAC,CAAI,CAAC;YAQzB,CAAC;QACH,CAAC,CAPC;IAQJ,CAAC,CAPC;AAQJ,CAAC;AAAA,CAPC","file":"config.js","sourceRoot":"","sourcesContent":["import {Injectable, EventEmitter, OpaqueToken, Inject} from '@angular/core';\nimport {IInViewConfig} from './config.interface';\n\nexport const INV_CONFIG = new OpaqueToken('INV_CONFIG');\n\n\nexport class InViewConfig {\n\n  _emitter = new EventEmitter();\n\n  private values: IInViewConfig = {\n\t\tthreshold: 0,\n\t\toffset: 0,\n  };\n\n  constructor( config: IInViewConfig = null) {\n    this.values = Object.assign({}, this.values, config || {});\n  }\n\n  update(config: IInViewConfig) {\n    this.values = Object.assign({}, this.values, config || {});\n    this._emitter.emit();\n  }\n\n  get(key: string) {\n    return (<any>this.values)[key];\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: undefined, decorators: [{ type: Inject, args: [INV_CONFIG, ] }, ]},\n];\n}\n\n// Intrenal decorator\nexport function InViewConfigurable(config = {changeDetectorProperty: 'cd'}) {\n  return function (constructor: Function) {\n    let { ngOnInit, ngOnDestroy } = constructor.prototype;\n\n    constructor.prototype.ngOnInit = function() {\n      const changeDetectorRef = this[config.changeDetectorProperty];\n\n      if (!changeDetectorRef || !changeDetectorRef.markForCheck) {\n        throw Error(`InViewConfig: invalid ChangeDetectorRef at property \"${config.changeDetectorProperty}\"`);\n      }\n\n      this.invConfigSubscription = this.config._emitter.subscribe(() => {\n        if (this.invOnConfigChanges) {\n          this.invOnConfigChanges();\n        }\n        changeDetectorRef.markForCheck();\n      });\n\n      if (ngOnInit) {\n        ngOnInit.call(this);\n      }\n    };\n\n    constructor.prototype.ngOnDestroy = function() {\n      if (this.invConfigSubscription) {\n        this.invConfigSubscription.unsubscribe();\n        this.invConfigSubscription = null;\n      }\n\n      if (ngOnDestroy) {\n        ngOnDestroy.call(this);\n      }\n    };\n  };\n};\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}